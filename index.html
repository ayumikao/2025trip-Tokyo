<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>9/20 澀谷 → 鎌倉 全天互動地圖</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>
  html,body,#map{height:100%;margin:0}
  .legend{background:#fff;padding:8px 10px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.15);font:12px/1.4 system-ui,-apple-system,"Noto Sans TC","PingFang TC","Microsoft JhengHei",sans-serif}
  .legend .dot{display:inline-block;width:10px;height:10px;border-radius:50%;margin-right:6px;vertical-align:middle}
  .card{font-family:system-ui,-apple-system,"Noto Sans TC","PingFang TC","Microsoft JhengHei",sans-serif;min-width:220px}
  .card h3{margin:0 0 6px;font-size:16px}
  .card .meta{color:#667;font-size:12px;margin-bottom:6px}
  .tag{display:inline-block;border:1px solid #ccd;padding:2px 6px;border-radius:999px;font-size:12px;text-decoration:none;color:#223;margin-right:6px;margin-top:4px}
  .muted{color:#789}
</style>
</head>
<body>
<div id="map"></div>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
// Base map
var map = L.map('map').setView([35.318,139.55], 12);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 19,
  attribution: '&copy; OpenStreetMap'
}).addTo(map);

// Groups
var gMain = L.layerGroup().addTo(map);
var gOptional = L.layerGroup().addTo(map);
var gToilet = L.layerGroup().addTo(map);

// Icons
function icon(color){ return L.divIcon({
  className:'',
  html:`<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
  <circle cx="14" cy="14" r="12" fill="white" stroke="${color}" stroke-width="2"/>
  <circle cx="14" cy="14" r="6" fill="${color}"/></svg>`,
  iconSize:[28,28], iconAnchor:[14,14], popupAnchor:[0,-10]
});}
var icMain = icon('#2E86DE');
var icOptional = icon('#9B59B6');
var icToilet = icon('#27AE60');

// Helper
function addStop(group, lat, lng, title, time, htmlMore){
  var p = L.marker([lat,lng], {icon: group===gOptional?icOptional:icMain}).addTo(group);
  p.bindPopup(`<div class="card"><h3>${title}</h3><div class="meta">${time||''}</div>${htmlMore||''}</div>`);
  return p;
}
function addToilet(lat,lng,title,desc,link){
  var p = L.marker([lat,lng], {icon: icToilet}).addTo(gToilet);
  var linkHtml = link?`<a class="tag" target="_blank" href="${link}">📍 Google 地圖</a>`:'';
  p.bindPopup(`<div class="card"><h3>🚻 ${title}</h3><div class="meta">${desc||''}</div>${linkHtml}</div>`);
}

// Main route points (approx coords)
var pts = [];
pts.push(addStop(gMain, 35.6580,139.7016, "澀谷出發（包車）", "06:30–08:00", `<a class="tag" target="_blank" href="https://maps.app.goo.gl/">📍 Google 地圖</a><div class="muted">預留 1.5 小時車程（含早高峰小堵車）</div>`));
pts.push(addStop(gMain, 35.3114,139.5341, "① 七高正門前（私人拍照點）", "08:00–08:50", `<a class="tag" target="_blank" href="https://maps.app.goo.gl/tMDZQV2oFisFafeV7">📍 Google 地圖</a><div class="muted">日本神奈川縣鐮倉市 Shichirigahamahigashi, 2 Chome−3</div>`));
pts.push(addStop(gMain, 35.3069,139.5259, "② 顯証寺（私人拍照點）", "同時段", `<a class="tag" target="_blank" href="https://maps.app.goo.gl/oDdhczm5XfwWtLur6">📍 Google 地圖</a><div class="muted">早光線柔和、人少。🚻 無公廁（需到錢洗弁財天或小町通）。</div>`));
pts.push(addStop(gMain, 35.3276,139.5221, "③ 湘南深澤站（倒掛鐵路）", "09:00–09:30", `<a class="tag" target="_blank" href="https://maps.app.goo.gl/">📍 Google 地圖</a><div class="muted">約 7 分鐘一班車，可拍 3–4 班。🚻 車站內公廁（西口側）。</div>`));
pts.push(addStop(gMain, 35.3263,139.5469, "④ 錢洗弁財天宇賀福神社", "09:40–10:50", `<a class="tag" target="_blank" href="https://maps.app.goo.gl/">📍 Google 地圖</a><div class="muted">水洗錢會發大財；線香+蠟燭+籃子 200 日幣。🚻 入口右側有簡易廁所。</div>`));
pts.push(addStop(gMain, 35.3213,139.5566, "⑤ 小町通商店街", "11:00–13:30", `<a class="tag" target="_blank" href="https://maps.app.goo.gl/">📍 Google 地圖</a><div class="muted">600m 逛街美食。🚻 多處公廁（7-11、LAWSON、商店街公廁）。</div>`));
pts.push(addStop(gMain, 35.3167,139.5352, "⑥ 高德院（鎌倉大佛）", "13:45–14:45", `<a class="tag" target="_blank" href="https://maps.app.goo.gl/">📍 Google 地圖</a><div class="muted">大人 300、小學生 150（現金），+50 可入內部。🚻 寺內與出入口附近有廁所。</div>`));
pts.push(addStop(gMain, 35.3088,139.4900, "⑦ YAMAKA 江之島店", "15:00–15:50", `<a class="tag" target="_blank" href="https://maps.app.goo.gl/">📍 Google 地圖</a><div class="muted">伴手禮購物。🚻 店內有廁所。</div>`));
pts.push(addStop(gMain, 35.3109,139.4857, "⑧ Rana 片瀬江ノ島（住宿）", "15:55–16:15", `<a class="tag" target="_blank" href="https://maps.app.goo.gl/7SVngCJPpPaxi4Sy6">📍 Google 地圖</a><div class="muted">Check-in 16:00–10:00。</div>`));
pts.push(addStop(gMain, 35.2988,139.4806, "⑨ 江之島（看夕陽）", "16:50–18:30", `<a class="tag" target="_blank" href="https://maps.app.goo.gl/">📍 Google 地圖</a><div class="muted">青銅鳥居入口。手扶梯：大人360/小學生180。傍晚需外套。🚻 島入口、各神社與商店街均有廁所。</div>`));

// Optional stops
addStop(gOptional, 35.3269,139.5591, "（可有可無）鶴岡八幡宮（抽御手）", "12:50–13:50", `<a class="tag" target="_blank" href="https://maps.app.goo.gl/">📍 Google 地圖</a><div class="muted">境內有公廁。</div>`);

// Toilets (examples near key areas)
addToilet(35.3099,139.5277, "7-11 鎌倉七里ガ浜店", "距離七高正門前約 4 分鐘車程；有停車位，廁所對外開放。", "https://maps.app.goo.gl/");

// Polyline route (approximate)
var latlngs = pts.map(m => m.getLatLng());
L.polyline(latlngs, {color:'#2E86DE', weight:4, opacity:.8}).addTo(gMain);

// Fit bounds
map.fitBounds(L.latLngBounds(latlngs), {padding:[30,30]});

// Controls
L.control.layers(null, {
  "主行程": gMain,
  "可有可無": gOptional,
  "🚻 廁所": gToilet
}, {collapsed:false, position:'topleft'}).addTo(map);

// Legend
var legend = L.control({position:'bottomleft'});
legend.onAdd = function(){
  var div = L.DomUtil.create('div','legend');
  div.innerHTML = `
    <div><span class="dot" style="background:#2E86DE"></span>主行程</div>
    <div><span class="dot" style="background:#9B59B6"></span>可有可無</div>
    <div><span class="dot" style="background:#27AE60"></span>🚻 廁所</div>
    <div class="muted" style="margin-top:6px">提示：點圖標看詳情，可直接開啟 Google 地圖導航。</div>`;
  return div;
};
legend.addTo(map);
</script>
</body>
</html>
